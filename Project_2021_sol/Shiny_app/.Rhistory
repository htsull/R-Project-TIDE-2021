tags$link(rel = "stylesheet", type = "text/css", href = "styling.css")
),
fluidRow(
column(4,
selectInput("decade",
label = "Choose decade",
choices = decade_val,
selected = "2010 - 2020"
),
selectInput("language",
label = "Choose language below",
choices = ""
),
selectInput("title",
label = "Choose title below",
choices = ""
)
),
column(8,
tableOutput("test")
)
)
)
ui<-dashboardPage(header, sidebar, body)
server <- function(input, output, session) {
observeEvent(
input$decade,
updateSelectInput(session,
inputId = "language",
label = "Language",
choices = uniLang())
)
uniLang <- reactive({
lang1 <- data_$language[data_$decade == input$decade]
lang2 <- paste(lang1, collapse = ',')
lang3 <- strsplit(lang2, ",")
lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
})
observeEvent(
input$language,
updateSelectInput(session,
inputId = "title",
label = "Title",
choices = titleChoices()
)
)
titleChoices <- reactive({
data_$title[data_$decade == input$decade & str_detect(data_$language, input$language)]
})
output$test <- renderTable({
output$test <- table()
})
}
# table <- function() {
#   tagList(HTML(glue::glue('
#
#                           <h1>Hello<h1/>
#
#
#                           ')
#               )
#         )
# }
table <- function() {print(data_)}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
tags$head(
tags$link(rel = "stylesheet", type = "text/css", href = "./www/styling.css")
)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
View(data_)
runApp()
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
apply(data_,2,max,na.rm=TRUE)
data_
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
library(shiny)
library(shinydashboard)
library(tidyverse)
library(stringr)
library(graphics)
library(gt)
library(glue)
source("modules.R")
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
apply(data_,2,max,na.rm=TRUE)
apply(data_$language,2,max,na.rm=TRUE)
apply(data_,1,max,na.rm=TRUE)
View(data_)
apply(data_$language,1,max,na.rm=TRUE)
data_ <- na.omit(data_)
View(data_)
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
data_ <- na.omit(data_$language)
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
data_ <- na.omit(data_$language)
data_$language[data_$language == "None"] <- NA
data_<- na.omit(data_, "language")
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
data_<- na.omit(data_, c("language"))
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
data_.dropna(language)
drop_na(data_)
drop_na(data_)
View(data_)
df <- drop_na(data_)
View(df)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
filter_data <- function(x){
paste0("data_$",x,"[data_$decade == input$decade & data_$title == input$title]")
}
runApp()
runApp()
runApp()
runApp()
runApp()
summary(data_)
data_$num_budget < as.numeric(data_$budget)
data_$num_budget < as.numeric(data_$budget)
num_budget
data_
data_$num_budget <- as.numeric(data_$budget)
View(data_)
data_$num_budget <- as.numeric(sub("$",replacement = ""), data_$budget)
data_$num_budget <- as.numeric(sub(x =  data_$budget, pattern = "$",replacement = ""))
View(data_)
data_$num_budget <- as.numeric(substr(x =  data_$budget, start = 1, stop = 2))
View(data_)
data_$num_budget <- substr(x =  data_$budget, start = 1, stop = 2)
data_$num_budget <- substr(x =  data_$budget, start = 2, stop = length(x))
data_$num_budget <- substr(x =  data_$budget, start = 2)
data_$num_budget <- substr(x =  data_$budget, start = 2, stop = Inf)
data_$num_budget <- substr(x =  data_$budget, start = 2, stop = length(.))
library(readr)
data_$num_budget <- parse_number(data_$budget)
install.packages("readr")
data_$num_budget <- parse_number(data_$budget)
data_ %>% mutate(budget = num_budget %>% str_remove_all("\\$,") %>% as.numeric())
data_ %>% mutate(num_budget= budget %>% str_remove_all("\\$,") %>% as.numeric())
data_$num_budget <- str_replace_all(data_$budget, "$","")
data_$num_budget <- str_replace(data_$budget, "$","")
View(data_)
data_$num_budget <- str_replace(string = data_$budget, pattern = "$", replacement = "")
data_$num_budget <- as.integer(sub("$", "",data_$budget))
View(data_)
data_$num_budget <- sub("$", "",data_$budget)
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
runApp()
runApp()
runApp()
runApp()
filter_data <- function(x){
eval(parse("data_$",x,"[data_$decade == input$decade & data_$title == input$title]"))
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
lang1 <- data_$actors
lang2 <- paste(lang1, collapse = ',')
lang3 <- strsplit(lang2, ",")
lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
library(shiny)
library(shinydashboard)
library(shinydashboardPlus)
library(tidyverse)
library(stringr)
library(graphics)
library(gt)
library(glue)
library(readr)
lang1 <- data_$actors
lang2 <- paste(lang1, collapse = ',')
lang3 <- strsplit(lang2, ",")
lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
lang4
lang1 <- data_$actors
lang2 <- paste(lang1, collapse = ',')
lang3 <- strsplit(lang2, ",")
lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# Shiny dashboard project
# TIDE 2021-2022
# Par Berthony Sully et Cl√©ment Landy
# Define dashboardHeader()
header <- dashboardHeader(title = "Movies Database",
tags$li(class="dropdown",
tags$a(href="https://github.com/aagarw30/R-Shinyapp-Tutorial",
icon("github"),
"Source Code",
target="_blank")
)
)
# Define dashboardSidebar()
sidebar <- dashboardSidebar(
sidebarMenu(
menuItem("Movies Infos", tabName = "movies_infos", icon = icon("film"),
badgeLabel =icon("info-circle"), badgeColor = "light-blue"),
menuItem("Data Table", icon = icon("th"), tabName = "data_table",
badgeLabel =icon("database"), badgeColor = "light-blue"),
menuItem("Hall of Fame", icon = icon("trophy"), tabName = "hall_of_fame",
badgeLabel =icon("sort-amount-up"), badgeColor = "light-blue")
)
)
# Define dashboardBody()
body <- dashboardBody(
# head links tag for css stylesheet
tags$head(
tags$link(rel = "stylesheet", type = "text/css", href = "stylesheet.css"),
tags$style("tfoot {display: table-header-group;}")
),
tabItems(
tabItem("movies_infos",
# Row srtucture
fluidRow(
column(3,
# Define User inputs
selectInput("decade",
label = "Choose decade",
choices = decade_val,
selected = NULL),
selectInput("title",
label = "Choose title below",
choices = ""),
textOutput("founds"),
),
column(9,
uiOutput("filtered_table")
)
)
),
tabItem("data_table",
fluidPage(
fluidRow(dataTableOutput("data_view")
)
)
),
tabItem("hall_of_fame")
)
)
# ui out to server
ui<-dashboardPage(header, sidebar, body)
################################################################################
# footer = dashboardFooter(
#     left = "By Divad Nojnarg",
#     right = "Zurich, 2019"
#     )
# selectInput("language",
#             label = "Choose language",
#             choices= c("All",testLang)
#             ),
# actionButton("submit",
#              label = "Submit",
#          icon = icon('angle-right',lib = 'font-awesome')
#          ),
# textOutput("test")
source("req_packages.R")
source("home_table.R")
path_ <- "./data_shiny_useable.csv"
data_ <- read.csv(file = path_, sep = ",", header = T, encoding = "uft-8")
decade_val <- unique(data_$decade) %>%  sort %>% as.list
data_$language[data_$language == "None"] <- NA
library(shiny)
library(shinydashboard)
library(shinydashboardPlus)
library(tidyverse)
library(stringr)
library(graphics)
library(gt)
library(glue)
library(readr)
server <- function(input, output, session) {
observeEvent(
input$decade,
updateSelectInput(session,
inputId = "title",
label = "Choose the title below",
choices = titleChoices()
)
)
titleChoices <- reactive({
data_$title[data_$decade == input$decade] %>% sort
})
# filtering data and rendering to htmlTable
output$filtered_table <- renderUI({
table(original_title = input$title,
year = data_$year[data_$decade == input$decade & data_$title == input$title],
director = data_$director[data_$decade == input$decade & data_$title == input$title],
genre = data_$genre[data_$decade == input$decade & data_$title == input$title],
writer = data_$writer[data_$decade == input$decade & data_$title == input$title],
duration = data_$duration[data_$decade == input$decade & data_$title == input$title],
production_company = data_$production_company[data_$decade == input$decade & data_$title == input$title],
country = data_$country[data_$decade == input$decade & data_$title == input$title],
actors = data_$actors[data_$decade == input$decade & data_$title == input$title],
language = data_$language[data_$decade == input$decade & data_$title == input$title],
avg_vote = data_$avg_vote[data_$decade == input$decade & data_$title == input$title],
budget = data_$budget[data_$decade == input$decade & data_$title == input$title],
description = data_$description[data_$decade == input$decade & data_$title == input$title]
)
})
# output of the findings length afer user input filter
output$founds <- reactive({
paste(data_$title[data_$decade == input$decade] %>% length(), "result(s) found")
})
out <-  data_ %>%
select(Title = original_title,
Genre = genre,
Duration = duration,
Country = country,
Language = language,
Director = director,
Writer = writer,
` Prod. Company` = production_company) %>% head()
output$data_view <- renderDataTable(
out,
options = list(pageLength = 20,
lengthChange = FALSE,
autoWidth = TRUE,
searching= T
)
)
}
#####################################################################
# titleChoices <- reactive({
#   data_$title[data_$decade == input$decade & str_detect(data_$language, input$language)]
# })
# observeEvent(
#   input$decade,
#   updateSelectInput(session,
#                     inputId = "language",
#                     label = "Language",
#                     choices = uniLang())
#   )
#
#to use fo language filter
# testLang <- data_$language[grepl("French", data_$language)] %>%
#   paste(collapse = ',') %>%
#   strsplit(",")
# testLang <- testLang[[1]] %>%
#   unique %>% sort() %>%  as.list()
# dashboardFooter <- function(left = NULL, right = NULL) {
#   htmltools::tags$footer(
#     class = "main-footer",
#     shiny::tags$div(class = "pull-right hidden-xs", right),
#     left
#     )
#
#   }
#
# filter_data <- function(x){
#   eval(parse("data_$",x,"[data_$decade == input$decade & data_$title == input$title]"))
# }
# slice_choices <- reactive({
#   data_$title[data_$decade == input$decade] %>% filter(contains("a"))
# })
#
# observeEvent(
#   input$decade,
#   updateSelectInput(session,
#                     inputId = "a_d",
#                     label = "A_D",
#                     choices = slice_choices()
#                     )
# )
#
# testServer <- eventReactive(input$submit, {
#   paste("click")
# })
#
# output$test <- reactive({
#   testServer()
#
# })
#
# observe({
#   if (input$choose_tab == "Automatic") {
#     output$test <- renderUI({
#       plotOutput("plot1", height = 250)
#     })
#   }
#   else if(input$choose_tab == "Manual") {
#     output$test <- renderUI({
#       plotOutput("plot2", height = 250, click = "plot_click")
#     })
#   }
# })
#
# filter_by <- reactive({
#   if(tolower(input$tab_fil1) == "actor"){
#     lang1 <- data_$actors
#     lang2 <- paste(lang1, collapse = ',')
#     lang3 <- strsplit(lang2, ",")
#     lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
#     return(lang4)
#
#   }else if(tolower(input$tab_fil1) == "language"){
#     lang1 <- data_$language[grepl(input$tab_fil1, data_$language)]
#     lang2 <- paste(lang1, collapse = ',')
#     lang3 <- strsplit(lang2, ",")
#     lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
#     return(lang4)
#
#   }else if(tolower(input$tab_fil1) == "genre"){
#     lang1 <- data_$genre[grepl(input$tab_fil1, data_$genre)]
#     lang2 <- paste(lang1, collapse = ',')
#     lang3 <- strsplit(lang2, ",")
#     lang4 <- lang3[[1]] %>% unique %>% sort() %>%  as.list()
#     return(lang4)
#   }
#
# })
#
# data_$original_title[grepl('Action', data_$genre)] %>% length()
#
# data_$actors[grepl(input$tab_fil1, data_$actors)]
# observeEvent(
#   input$tab_fil1,
#   updateSelectInput(session,
#                     inputId = "tab_fil2",
#                     label = paste("Choose the", tolower(input$tab_fil1) ,"below"),
#                     choices = filter_by()
#   )
# )
runApp()
